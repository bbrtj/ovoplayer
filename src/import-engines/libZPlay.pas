 {
 *
 *  libzplay - windows ( WIN32 ) multimedia library
 *
 *  ver: 2.00
 *  date: 22. April, 2010.
 *
 *  Copyright (C) 2003-2010 Zoran Cindori
 *
 *  Author: Zoran Cindori
 *  Web: http://libzplay.sourceforge.net/
 *  Email: zcindori@inet.hr
 *
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 *
 *
 *
 * Supported by:
 *
 * ============================================================================
 * libmad - MPEG audio decoder library
 * Copyright (C) 2000-2004 Underbit Technologies, Inc. <support@underbit.com>
 * http://www.underbit.com/products/mad/
 * GNU General Public License ( GPL.TXT )
 * ============================================================================
 * THE OggVorbis SOURCE CODE IS (C) COPYRIGHT 1994-2002 
 * by the Xiph.Org Foundation http://www.xiph.org/
 * BSD-STYLE SOURCE LICENSE  ( XIPH.TXT )
 * ============================================================================
 * LIBA52
 * free library for decoding ATSC A/52 streams.
 * It is released under the terms of the GPL license.
 * ============================================================================
 * FLAC - Free Lossless Audio Codec
 * Copyright (C) 2001,2002,2003,2004,2005,2006,2007  Josh Coalson
 * http://flac.sourceforge.net/
 *
 * This file is part the FLAC project.  FLAC is comprised of several
 * components distributed under difference licenses.  The codec libraries
 * are distributed under Xiph.Org's BSD-like license (see the file
 * XIPH.TXT in this distribution).  All other programs, libraries, and
 * plugins are distributed under the LGPL or GPL (see LGPL.TXT and
 * GPL.TXT).  The documentation is distributed under the Gnu FDL (see
 * FDL.TXT).  Each file in the FLAC distribution contains at the top the
 * terms under which it may be distributed.
 *
 * Since this particular file is relevant to all components of FLAC,
 * it may be distributed under the Xiph.Org license, which is the least
 * restrictive of those mentioned above.  See the file XIPH.TXT in this
 * distribution.
 * ============================================================================
 * FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
 * Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 *
 * Any non-GPL usage of this software or parts of this software is strictly
 * forbidden.
 *
 * The "appropriate copyright message" mentioned in section 2c of the GPLv2
 * must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
 *
 * Commercial non-GPL licensing of this software is possible.
 * For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 *
 * ============================================================================
 * FAAC - Freeware Advanced Audio Coder Copyright (C) 2001 M. Bakker
 * This library is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as published by the
 * Free Software Foundation; either version 2.1 of the License, or
 * (at your option) any later version. 
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU Lesser General Public License for more details. 
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this library; if not, write to the Free Software Foundation,
 * Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA 
 *
 * ============================================================================
 * libmp3lame encoder
 * LAME 3.xx LAME Ain't an MP3 Encoder http://www.mp3dev.org March 2001 
 * 
 * Originally developed by Mike Cheng (www.uq.net.au/~zzmcheng).
 * Now maintained by Mark Taylor (www.mp3dev.org). 
 *
 * This code is distributed under the GNU LESSER PUBLIC LICENSE (LGPL, see www.gnu.org)
 * with the following modification: 
 * 
 * If you determine that distribution of LAME requires a patent license,
 * and you obtain a patent license, you may distribute LAME even though redistribution
 * of LAME may also require a patent license. 
 *
 * You agree not to enforce any patent claims for any aspect of MPEG audio compression,
 * or any other techniques contained in the LAME source code. 
 *
 * Copyrights (c) 1999-1007 by The LAME Project Copyrights (c) 1999,2000,2001
 * by Mark Taylor Copyrights (c) 1999,2000,2001 by Mark Taylor Copyrights
 * (c) 1998 by Michael Cheng Copyrights (c) 1995,1996,1997 by Michael Hipp: mpglib
 *
 * ============================================================================
 * SoundTouch library Copyright (c) Olli Parviainen 2002-2009 
 * http://www.surina.net/soundtouch
 * GNU Lesser General Public License vesrion 2.1 (LGPL.TXT )
 * ============================================================================
 * Center Cut DSP Plugin for Winamp 2.x 
 * Copyright (C) 2004  Moitah (moitah@yahoo.com)
 * GNU General Public License ( GPL.TXT )
 * ============================================================================
 * Shibatch Super Equalizer ver 0.03 for winamp
 * written by Naoki Shibata  shibatch@users.sourceforge.net
 * http://shibatch.sourceforge.net/
 *
 * Shibatch Super Equalizer (except FFT part) is distributed under LGPL.
 * See LGPL.txt for details.
 * FFT part is a routine made by Mr.Ooura. This routine is a freeware.
 * Contact Mr.Ooura for details of distributing licenses.
 * http://momonga.t.u-tokyo.ac.jp/~ooura/fft.html
 * ============================================================================
 * The Independent JPEG Group's JPEG software
 * JPEG decoding library
 * Copyright (C) 1991-2010, Thomas G. Lane, Guido Vollbeding.
 * www.ijg.org
 * ============================================================================
 * ZLIB DATA COMPRESSION LIBRARY
 * (C) 1995-2010 Jean-loup Gailly and Mark Adler
 * http://zlib.net/ 
 * ============================================================================
 * libpng library
 * PNG picture decoding library
 * Copyright (c) 2004, 2006-2007 Glenn Randers-Pehrson
 * http://www.libpng.org/
 * ============================================================================
*

}


unit libZPlay;

interface

uses
  windows, SysUtils, Classes, Graphics, dynlibs;


type  TSettingID = (
        sidWaveBufferSize = 1,
        sidAccurateLength = 2,
        sidAccurateSeek = 3,
        sidSamplerate = 4,
        sidChannelNumber = 5,
        sidBitPerSample = 6,
        sidBigEndian = 7
);

type  TFFTGraphSize = (FFTGraphMinWidth = 100, FFTGraphMinHeight = 60);

const TWaveOutMapper: Integer = -1;
const TWaveInMapper: Integer = -1;

        
type TStreamFormat = (sfUnknown = 0,
                        sfMp3 = 1,
                        sfOgg = 2,
                        sfWav = 3,
                        sfPCM = 4,
                        sfFLAC = 5,
                        sfFLACOgg = 6,
		                    sfAC3 = 7,
		                    sfAacADTS = 8,
                        sfWaveIn = 9,
		                    sfAutodetect = 1000
);

type TBPMDetectionMethod = (
        dmPeaks = 0,
        dmAutoCorrelation = 1
);

type TFFTGraphParamID = (
        gpFFTPoints = 1,
        gpGraphType = 2,
        gpWindow = 3,
        gpHorizontalScale = 4,
        gpSubgrid = 5,
        gpTransparency = 6 ,
        gpFrequencyScaleVisible,
	    gpDecibelScaleVisible,
	    gpFrequencyGridVisible,
	    gpDecibelGridVisible,
	    gpBgBitmapVisible,
	    gpBgBitmapHandle,
	    gpColor1,
	    gpColor2,
	    gpColor3,
	    gpColor4,
	    gpColor5,
	    gpColor6,
	    gpColor7,
	    gpColor8,
	    gpColor9,
	    gpColor10,
	    gpColor11,
	    gpColor12,
	    gpColor13,
	    gpColor14,
	    gpColor15,
	    gpColor16
);

type TFFTGraphType = (
        gtLinesLeftOnTop = 0,
        gtLinesRightOnTop  = 1,
        gtAreaLeftOnTop = 2,
        gtAreaRightOnTop = 3,
        gtBarsLeftOnTop = 4,
        gtBarsRightOnTop = 5 ,
        gtSpectrum = 6
);

type TTimeFormat = (
        tfMillisecond = 1,
        tfSecond = 2,
        tfHMS = 4,
        tfSamples = 8
);

type TFFTWindow = (
        fwRectangular = 1,
        fwHamming = 2,
        fwHann = 3,
        fwCosine = 4,
        fwLanczos = 5,
        fwBartlett = 6,
        fwTriangular = 7,
        fwGauss = 8,
        fwBartlettHann = 9,
        fwBLackman = 10,
        fwNuttall = 11,
        fwBlackManHarris = 12,
        fwBlackmanNuttall = 13,
        fwFlatTop = 14
);


type TSeekMethod = (
        smFromBeginning = 1,
        smFromEnd = 2,
        smFromCurrentForward = 4,
        smFromCurrentBackward = 8
);


type TID3Version = (
        id3Version1 = 1,
        id3Version2 = 2
);



type
  TStreamLoadInfo = record
	  NumberOfBuffers: Cardinal;
	  NumberOfBytes: Cardinal;
end;



type TWaveOutFormat = (
format_invalid = 0,
format_11khz_8bit_mono = 1,
format_11khz_8bit_stereo = 2,
format_11khz_16bit_mono = 4,
format_11khz_16bit_stereo = 8,

format_22khz_8bit_mono = 16,
format_22khz_8bit_stereo = 32,
format_22khz_16bit_mono = 64,
format_22khz_16bit_stereo = 128,

format_44khz_8bit_mono = 256,
format_44khz_8bit_stereo = 512,
format_44khz_16bit_mono = 1024,
format_44khz_16bit_stereo = 2048
);

type TWaveOutFunctionality = (
supportPitchControl = 1,
supportPlaybackRateControl = 2,
supportVolumeControl = 4,
supportSeparateLeftRightVolume = 8,
supportSync = 16,
supportSampleAccuratePosition = 32,
supportDirectSound = 64
);


type
  TWaveOutInfo = record
    ManufacturerID: Cardinal;
    ProductID: Cardinal;
    DriverVersion: Cardinal;
    Formats: Cardinal;
    Channels: Cardinal;
    Support: Cardinal;
    ProductName: AnsiString;
end;

type
  TWaveOutInfoW = record
    ManufacturerID: Cardinal;
    ProductID: Cardinal;
    DriverVersion: Cardinal;
    Formats: Cardinal;
    Channels: Cardinal;
    Support: Cardinal;
    ProductName: WideString;
end;



type
  TWaveInInfo = record
    ManufacturerID: Cardinal;
    ProductID: Cardinal;
    DriverVersion: Cardinal;
    Formats: Cardinal;
    Channels: Cardinal;
    ProductName: AnsiString;
end;

type
  TWaveInInfoW = record
    ManufacturerID: Cardinal;
    ProductID: Cardinal;
    DriverVersion: Cardinal;
    Formats: Cardinal;
    Channels: Cardinal;
    ProductName: WideString;
end;


type
  TStreamHMSTime = record
    hour: Cardinal;
    minute: Cardinal;
    second: Cardinal;
    millisecond: Cardinal;
end;

type
  TStreamTime = record
	  sec: Cardinal;
	  ms: Cardinal;
    samples: Cardinal;
    hms: TStreamHMSTime
end;



type
  TID3Info = record
    Title: AnsiString;
    Artist: AnsiString;
    Album: AnsiString;
    Year: AnsiString;
    Comment: AnsiString;
    Track: AnsiString;
    Genre: AnsiString;
end;

type
  TID3InfoW = record
    Title: WideString;
    Artist: WideString;
    Album: WideString;
    Year: WideString;
    Comment: WideString;
    Track: WideString;
    Genre: WideString;
end;

type
  TID3Picture = record
	PicturePresent: Boolean;
	PictureType: Integer;
	Description: AnsiString;
  Bitmap: TPicture;
end;

type
  TID3PictureW = record
	PicturePresent: Boolean;
	PictureType: Integer;
	Description: WideString;
  Bitmap: TPicture;
end;


type
  TID3InfoExW = record
	Title: WideString;
	Artist: WideString;
	Album: WideString;
	Year: WideString;
	Comment: WideString;
	Track: WideString;
  Genre: WideString;
	AlbumArtist: WideString;
	Composer: WideString;
	OriginalArtist: WideString;
	Copyright: WideString;
	URL: WideString;
	Encoder: WideString;
	Publisher: WideString;
	BPM: Cardinal;
	Picture: TID3PictureW;
end;


type
  TID3InfoEx = record
	Title: AnsiString;
	Artist: AnsiString;
	Album: AnsiString;
	Year: AnsiString;
	Comment: AnsiString;
	Track: AnsiString;
  Genre: AnsiString;
	AlbumArtist: AnsiString;
	Composer: AnsiString;
	OriginalArtist: AnsiString;
	Copyright: AnsiString;
	URL: AnsiString;
	Encoder: AnsiString;
	Publisher: AnsiString;
	BPM: Cardinal;
	Picture: TID3Picture;
end;

type
  TStreamInfo = record
	  SamplingRate: Cardinal;
	  ChannelNumber: Cardinal;
    VBR: Boolean;
    Bitrate: Cardinal;
    Length: TStreamTime;
	  Description: AnsiString;
end;

type
  TStreamInfoW = record
 	  SamplingRate: Cardinal;
	  ChannelNumber: Cardinal;
    VBR: Boolean;
    Bitrate: Cardinal;
    Length: TStreamTime;
	  Description: WideString;
end;

// ===================================================================
// STREAM STATUS
type
  TStreamStatus = record
    fPlay: Boolean;
    fPause: Boolean;
    fEcho: Boolean;
    fEqualizer: Boolean;
    fVocalCut: Boolean;
    fSideCut: Boolean;
    fChannelMix: Boolean;
    fSlideVolume: Boolean;
    nLoop: Integer;
    fReverse: Boolean;
    nSongIndex: Integer;
	  nSongsInQueue: Integer;
end;


// ======================================================================

type
  TEchoEffect = record
    LeftDelay: Integer;
    LeftSrcVolume: Integer;
    LeftEchoVolume: Integer;
    RightDelay: Integer;
    RightSrcVolume: Integer;
    RightEchoVolume: Integer;
end;


type TDynamicEchoEffectArray = array of TEchoEffect;
type TDynamicIntegerArray = array of Integer;



type TFFTGraphHorizontalScale = ( gsLogarithmic = 0, gsLinear = 1);

const
MsgStopAsync = 1;
MsgPlayAsync = 2;
MsgEnterLoopAsync = 4;
MsgExitLoopAsync = 8;
MsgEnterVolumeSlideAsync = 16;
MsgExitVolumeSlideAsync = 32;
MsgStreamBufferDoneAsync = 64;
MsgStreamNeedMoreDataAsync = 128;
MsgNextSongAsync = 256;
MsgStop = 65536;
MsgPlay = 131072;
MsgEnterLoop = 262144;
MsgExitLoop = 524288;
MsgEnterVolumeSlide = 1048576;
MsgExitVolumeSlide = 2097152;
MsgStreamBufferDone = 4194304;
MsgStreamNeedMoreData = 8388608;
MsgNextSong = 16777216;
MsgWaveBuffer = 33554432;
MsgAll = cardinal(-1);
MsgAllAsync = 65535;
MsgAllSync = -65536;


// =======================================================================

type TCallbackFunc = function(objptr: Pointer; user_data: pointer; msg: Cardinal; param1: Cardinal; param2: Cardinal): Integer; stdcall;



type PSTREAM_LOAD_INFO = ^TStreamLoadInfo;
type
  ID3_PICTURE = record
	PicturePresent: Cardinal;
	CanDrawPicture: Cardinal;
	MIMEType: PAnsiChar;
	PictureType: Integer;
	Description: PAnsiChar;
	PictureData: Pointer;
	PictureDataSize: Integer;
	hBitmap: HBITMAP;
	Width: Cardinal;
	Height: Cardinal;
	reserved: array[0..128] of Char;
end;

type
  ID3_PICTUREW = record
	PicturePresent: Cardinal;
	CanDrawPicture: Cardinal;
	MIMEType: PWideChar;
	PictureType: Integer;
	Description: PWideChar;
	PictureData: Pointer;
	PictureDataSize: Integer;
	hBitmap: HBITMAP;
	Width: Cardinal;
	Height: Cardinal;
	reserved: array[0..128] of Char;
end;

type
    ID3_INFO = record
      Title: PAnsiChar;
      Artist: PAnsiChar;
      Album: PAnsiChar;
      Year: PAnsiChar;
      Comment: PAnsiChar;
      TrackNum: PAnsiChar;
      Genre: PAnsiChar;
end;

type
    ID3_INFOW = record
      Title: PWideChar;
      Artist: PWideChar;
      Album: PWideChar;
      Year: PWideChar;
      Comment: PWideChar;
      TrackNum: PWideChar;
      Genre: PWideChar;
end;





type
  ID3_INFOEX = record
	Title: PAnsiChar;
	Artist: PAnsiChar;
	Album: PAnsiChar;
	Year: PAnsiChar;
	Comment: PAnsiChar;
	TrackNum: PAnsiChar;
  Genre: PAnsiChar;
	AlbumArtist: PAnsiChar;
	Composer: PAnsiChar;
	OriginalArtist: PAnsiChar;
	Copyright: PAnsiChar;
	URL: PAnsiChar;
	Encoder: PAnsiChar;
	Publisher: PAnsiChar;
	BPM: Cardinal;
	Picture: ID3_PICTURE;
	reserved: array[0 .. 128] of Char;
end;

type
  ID3_INFOEXW = record
	Title: PWideChar;
	Artist: PWideChar;
	Album: PWideChar;
	Year: PWideChar;
	Comment: PWideChar;
	TrackNum: PWideChar;
  Genre: PWideChar;
	AlbumArtist: PWideChar;
	Composer: PWideChar;
	OriginalArtist: PWideChar;
	Copyright: PWideChar;
	URL: PWideChar;
	Encoder: PWideChar;
	Publisher: PWideChar;
	BPM: Cardinal;
	Picture: ID3_PICTUREW;
	reserved: array[0 .. 128] of Char;
end;

type PID3_INFOEX = ^ID3_INFOEX;
type PID3_INFOEXW = ^ID3_INFOEXW;
type PID3_PICTURE = ^ID3_PICTURE;
type PID3_PICTUREW = ^ID3_PICTUREW;
type PECHO_EFFECT = ^TEchoEffect;
type PID3_INFO = ^ID3_INFO;
type PID3_INFOW = ^ID3_INFOW;

type PSTREAM_TIME = ^TStreamTime;


type
  STREAM_INFO = record
    nSamplingRate: Cardinal;
    nChannelNumber: Cardinal;
    fVBR: Cardinal;
    nBitrate: Cardinal;
    timeLength: TStreamTime;
    pchDescription: PAnsiChar
end;

type PSTREAM_INFO = ^STREAM_INFO;

type
  STREAM_INFOW = record
	  nSamplingRate: Cardinal;
	  nChannelNumber: Cardinal;
    fVBR: Cardinal;
    nBitrate: Cardinal;
    timeLength: TStreamTime;
	  pchDescription: PWideChar;
end;

type PSTREAM_INFOW = ^STREAM_INFOW;

type PSTREAM_STATUS = ^TStreamStatus;


type
  WMP3_STREAM_STATUS = record
    fPlay: Integer;
    fPause: Integer;
    fEcho: Integer;
    fEqualizer: Integer;
    fVocalCut: Integer;
    fSideCut: Integer;
    fChannelMix: Integer;
    fFade: Integer;
    nLoop: Integer;
    fReverse: Integer;
   	nSongIndex: Integer;
	nSongsInQueue: Integer;
end;



type
  WAVEOUT_INFO = record
    ManufacturerID: Cardinal;
    ProductID: Cardinal;
    DriverVersion: Cardinal;
    Formats: Cardinal;
    Channels: Cardinal;
    Support: Cardinal;
    ProductName: PAnsiChar;
end;

type PWAVEOUT_INFO = ^WAVEOUT_INFO;

type
  WAVEOUT_INFOW = record
    ManufacturerID: Cardinal;
    ProductID: Cardinal;
    DriverVersion: Cardinal;
    Formats: Cardinal;
    Channels: Cardinal;
    Support: Cardinal;
    ProductName: PWideChar;
end;

type PWAVEOUT_INFOW = ^WAVEOUT_INFOW;




type
  WAVEIN_INFO = record
    ManufacturerID: Cardinal;
    ProductID: Cardinal;
    DriverVersion: Cardinal;
    Formats: Cardinal;
    Channels: Cardinal;
    ProductName: PAnsiChar;
end;

type PWAVEIN_INFO = ^WAVEIN_INFO;

type
  WAVEIN_INFOW = record
    ManufacturerID: Cardinal;
    ProductID: Cardinal;
    DriverVersion: Cardinal;
    Formats: Cardinal;
    Channels: Cardinal;
    ProductName: PWideChar;
end;

type PWAVEIN_INFOW = ^WAVEIN_INFOW;
    ZPLAY_HANDLE = pointer;
var
  zplay_CreateZPlay : function:ZPLAY_HANDLE;cdecl;
zplay_DestroyZPlay : function(handle:ZPLAY_HANDLE):longint;cdecl;
zplay_GetVersion : function(handle:ZPLAY_HANDLE):longint;cdecl;
zplay_GetError : function(handle:ZPLAY_HANDLE):Pchar;cdecl;
zplay_GetErrorW : function(handle:ZPLAY_HANDLE):PWideChar;cdecl;
zplay_GetFileFormat : function(handle:ZPLAY_HANDLE; pchFileName:Pchar):TStreamFormat;cdecl;
zplay_GetFileFormatW : function(handle:ZPLAY_HANDLE; pchFileName:PWideChar):TStreamFormat;cdecl;
zplay_EnumerateWaveOut : function(handle:ZPLAY_HANDLE):longint;cdecl;
zplay_GetWaveOutInfo : function(handle:ZPLAY_HANDLE; nIndex:dword; var pWaveOutInfo:TWaveOutInfo):longint;cdecl;
zplay_GetWaveOutInfoW : function(handle:ZPLAY_HANDLE; nIndex:dword; var pWaveOutInfo:TWaveOutInfoW):longint;cdecl;
zplay_SetWaveOutDevice : function(handle:ZPLAY_HANDLE; nIndex:dword):longint;cdecl;
zplay_OpenFile : function(handle:ZPLAY_HANDLE; sFileName:Pchar; nFormat:TStreamFormat):longint;cdecl;
zplay_OpenFileW : function(handle:ZPLAY_HANDLE; sFileName:PWideChar; nFormat:TStreamFormat):longint;cdecl;
zplay_AddFile : function(handle:ZPLAY_HANDLE; sFileName:Pchar; nFormat:TStreamFormat):longint;cdecl;
zplay_AddFileW : function(handle:ZPLAY_HANDLE; sFileName:PWideChar; nFormat:TStreamFormat):longint;cdecl;
zplay_OpenStream : function(handle:ZPLAY_HANDLE; fBuffered:longint; fManaged:longint; sMemStream:pointer; nStreamSize:dword; 
        nFormat:TStreamFormat):longint;cdecl;
zplay_PushDataToStream : function(handle:ZPLAY_HANDLE; sMemNewData:pointer; nNewDataize:dword):longint;cdecl;
zplay_IsStreamDataFree : function(handle:ZPLAY_HANDLE; sMemNewData:pointer):longint;cdecl;
zplay_GetDynamicStreamLoad : procedure(handle:ZPLAY_HANDLE; var pStreamLoadInfo:TStreamLoadInfo);cdecl;
zplay_GetStreamInfo : procedure(handle:ZPLAY_HANDLE; var pInfo:TStreamInfo);cdecl;
zplay_GetStreamInfoW : procedure(handle:ZPLAY_HANDLE; var pInfo:TStreamInfoW);cdecl;
zplay_Close : function(handle:ZPLAY_HANDLE):longint;cdecl;
zplay_Play : function(handle:ZPLAY_HANDLE):longint;cdecl;
zplay_PlayLoop : function(handle:ZPLAY_HANDLE; fFormatStartTime:TTimeFormat; var pStartTime:TStreamTime; fFormatEndTime:TTimeFormat; var pEndTime:TStreamTime; 
        nNumOfCycles:dword; fContinuePlaying:dword):longint;cdecl;
zplay_Seek : function(handle:ZPLAY_HANDLE; fFormat:TTimeFormat; var pTime:TStreamTime; nMoveMethod:TSeekMethod):longint;cdecl;
zplay_ReverseMode : function(handle:ZPLAY_HANDLE; fEnable:longint):longint;cdecl;
zplay_Stop : function(handle:ZPLAY_HANDLE):longint;cdecl;
zplay_Pause : function(handle:ZPLAY_HANDLE):longint;cdecl;
zplay_Resume : function(handle:ZPLAY_HANDLE):longint;cdecl;
zplay_GetPosition : procedure(handle:ZPLAY_HANDLE; var pTime:TStreamTime);cdecl;
zplay_SetMasterVolume : function(handle:ZPLAY_HANDLE; nLeftVolume:dword; nRightVolume:dword):longint;cdecl;
zplay_SetPlayerVolume : function(handle:ZPLAY_HANDLE; nLeftVolume:dword; nRightVolume:dword):longint;cdecl;
zplay_GetMasterVolume : procedure(handle:ZPLAY_HANDLE; var pnLeftVolume:dword; var pnRightVolume:dword);cdecl;
zplay_GetPlayerVolume : procedure(handle:ZPLAY_HANDLE; var pnLeftVolume:dword; var pnRightVolume:dword);cdecl;
zplay_GetBitrate : function(handle:ZPLAY_HANDLE; fAverage:longint):longint;cdecl;
zplay_GetStatus : procedure(handle:ZPLAY_HANDLE; var pStatus:TStreamStatus);cdecl;
zplay_MixChannels : function(handle:ZPLAY_HANDLE; fEnable:longint; nLeftPercent:dword; nRightPercent:dword):longint;cdecl;
zplay_GetVUData : procedure(handle:ZPLAY_HANDLE; var pnLeftChannel:dword; var pnRightChannel:dword);cdecl;
zplay_SlideVolume : function(handle:ZPLAY_HANDLE; fFormatStart:longint; var pTimeStart:TStreamTime; nStartVolumeLeft:dword; nStartVolumeRight:dword; 
        fFormatEnd:longint; var pTimeEnd:TStreamTime; nEndVolumeLeft:dword; nEndVolumeRight:dword):longint;cdecl;
zplay_EnableEqualizer : function(handle:ZPLAY_HANDLE; fEnable:longint):longint;cdecl;
zplay_SetEqualizerPoints : function(handle:ZPLAY_HANDLE; var pnFreqPoint:longint; nNumOfPoints:longint):longint;cdecl;
zplay_GetEqualizerPoints : function(handle:ZPLAY_HANDLE; var pnFreqPoint:longint; nFreqPointNumber:longint):longint;cdecl;
zplay_SetEqualizerParam : function(handle:ZPLAY_HANDLE; nPreAmpGain:longint; var pnBandGain:longint; nNumberOfBands:longint):longint;cdecl;
zplay_GetEqualizerParam : function(handle:ZPLAY_HANDLE; var pnPreAmpGain:longint; var pnBandGain:longint; nNumberOfBands:longint):longint;cdecl;
zplay_LoadID3 : function(handle:ZPLAY_HANDLE; nId3Version:TID3Version; var pId3Info:TID3Info):longint;cdecl;
zplay_LoadID3W : function(handle:ZPLAY_HANDLE; nId3Version:TID3Version; var pId3Info:TID3InfoW):longint;cdecl;
zplay_LoadFileID3 : function(handle:ZPLAY_HANDLE; pchFileName:Pchar; nFormat:TStreamFormat; nId3Version:TID3Version; var pId3Info:TID3Info):longint;cdecl;
zplay_LoadFileID3W : function(handle:ZPLAY_HANDLE; pchFileName:PWideChar; nFormat:TStreamFormat; nId3Version:TID3Version; var pId3Info:TID3InfoW):longint;cdecl;
zplay_EnableEcho : function(handle:ZPLAY_HANDLE; fEnable:longint):longint;cdecl;
zplay_SetEchoParam : function(handle:ZPLAY_HANDLE; var pEchoEffect:TEchoEffect; nNumberOfEffects:longint):longint;cdecl;
zplay_GetEchoParam : function(handle:ZPLAY_HANDLE; var pEchoEffectm:TEchoEffect; nNumberOfEffects:longint):longint;cdecl;
zplay_SetCallbackFunc : function(handle:ZPLAY_HANDLE; pCallbackFunc:TCallbackFunc; nMessages:Cardinal; user_data:pointer):longint;cdecl;
zplay_GetFFTData : function(handle:ZPLAY_HANDLE; nFFTPoints:longint; nFFTWindow:TFFTWindow; var pnHarmonicNumber:longint; var pnHarmonicFreq:longint; 
        var pnLeftAmplitude:longint; var pnRightAmplitude:longint; var pnLeftPhase:longint; var pnRightPhase:longint):longint;cdecl;
zplay_SetRate : function(handle:ZPLAY_HANDLE; nRate:dword):longint;cdecl;
zplay_GetRate : function(handle:ZPLAY_HANDLE):dword;cdecl;
zplay_SetPitch : function(handle:ZPLAY_HANDLE; nPitch:dword):longint;cdecl;
zplay_GetPitch : function(handle:ZPLAY_HANDLE):dword;cdecl;
zplay_SetTempo : function(handle:ZPLAY_HANDLE; nTempo:dword):longint;cdecl;
zplay_GetTempo : function(handle:ZPLAY_HANDLE):dword;cdecl;
zplay_StereoCut : function(handle:ZPLAY_HANDLE; fEnable:longint; fOutputCenter:longint; fBassToSides:longint):longint;cdecl;
zplay_DrawFFTGraphOnHDC : function(handle:ZPLAY_HANDLE; hdc:tHandle; nX:longint; nY:longint; nWidth:longint;
        nHeight:longint):longint;cdecl;
zplay_DrawFFTGraphOnHWND : function(handle:ZPLAY_HANDLE; hwnd:tHandle; nX:longint; nY:longint; nWidth:longint;
        nHeight:longint):longint;cdecl;
zplay_SetFFTGraphParam : function(handle:ZPLAY_HANDLE; nParamID:TFFTGraphParamID; nParamValue:longint):longint;cdecl;
zplay_GetFFTGraphParam : function(handle:ZPLAY_HANDLE; nParamID:TFFTGraphParamID):longint;cdecl;
zplay_DetectBPM : function(handle:ZPLAY_HANDLE; nMethod:TBPMDetectionMethod):longint;cdecl;
zplay_DetectFileBPM : function(handle:ZPLAY_HANDLE; pchFileName:Pchar; nFormat:TStreamFormat; nMethod:TBPMDetectionMethod):longint;cdecl;
zplay_DetectFileBPMW : function(handle:ZPLAY_HANDLE; pchFileName:PWideChar; nFormat:TStreamFormat; nMethod:TBPMDetectionMethod):longint;cdecl;
zplay_SetEqualizerPreampGain : function(handle:ZPLAY_HANDLE; nGain:longint):longint;cdecl;
zplay_GetEqualizerPreampGain : function(handle:ZPLAY_HANDLE):longint;cdecl;
zplay_SetEqualizerBandGain : function(handle:ZPLAY_HANDLE; nBandIndex:longint; nGain:longint):longint;cdecl;
zplay_GetEqualizerBandGain : function(handle:ZPLAY_HANDLE; nBandIndex:longint):longint;cdecl;
zplay_SetSettings : function(handle:ZPLAY_HANDLE; nSettingID:TSettingID; nValue:longint):longint;cdecl;
zplay_GetSettings : function(handle:ZPLAY_HANDLE; nSettingID:TSettingID):longint;cdecl;
zplay_strlen : function(s:Pchar):dword;cdecl;
zplay_wcslen : function(s:PWideChar):dword;cdecl;
zplay_memcpy : procedure(dest:pointer; src:pointer; n:dword);cdecl;
zplay_memmove : procedure(dest:pointer; src:pointer; n:dword);cdecl;
zplay_strcpy : function(dest:Pchar; src:Pchar):Pchar;cdecl;
zplay_wcscpy : function(dest:PWideChar; src:PWideChar):PWideChar;cdecl;
zplay_memset : function(s:pointer; c:longint; n:dword):pointer;cdecl;
zplay_LoadID3Ex : function(handle:ZPLAY_HANDLE; var pId3Info:TID3InfoEx; fDecodeEmbededPicture:dword):longint;cdecl;
zplay_LoadID3ExW : function(handle:ZPLAY_HANDLE; var pId3Info:TID3InfoExW; fDecodeEmbededPicture:dword):longint;cdecl;
zplay_LoadFileID3Ex : function(handle:ZPLAY_HANDLE; pchFileName:Pchar; nFormat:TStreamFormat; var pId3Info:TID3InfoEx; fDecodeEmbededPicture:dword):longint;cdecl;
zplay_LoadFileID3ExW : function(handle:ZPLAY_HANDLE; pchFileName:PWideChar; nFormat:TStreamFormat; var pId3Info:TID3InfoExW; fDecodeEmbededPicture:dword):longint;cdecl;
zplay_DrawBitmapToHDC : function(handle:ZPLAY_HANDLE; hdc:pointer; X:longint; Y:longint; Width:longint; 
        Height:longint; hBitmap:pointer):longint;cdecl;
zplay_DrawBitmapToHWND : function(handle:ZPLAY_HANDLE; hwnd:pointer; X:longint; Y:longint; Width:longint; 
        Height:longint; hBitmap:pointer):longint;cdecl;
zplay_EnumerateWaveIn : function(handle:ZPLAY_HANDLE):longint;cdecl;
zplay_GetWaveInInfo : function(handle:ZPLAY_HANDLE; nIndex:dword; var pWaveInInfo:TWaveInInfo):longint;cdecl;
zplay_GetWaveInInfoW : function(handle:ZPLAY_HANDLE; nIndex:dword; var pWaveInInfo:TWaveInInfoW):longint;cdecl;
zplay_SetWaveInDevice : function(handle:ZPLAY_HANDLE; nIndex:dword):longint;cdecl;
zplay_SetWaveOutFile : function(handle:ZPLAY_HANDLE; sFileName:Pchar; nFormat:TStreamFormat; fOutputToSoundcard:dword):longint;cdecl;
zplay_SetWaveOutFileW : function(handle:ZPLAY_HANDLE; sFileName:PWideChar; nFormat:TStreamFormat; fOutputToSoundcard:dword):longint;cdecl;  


Const
  External_library= 'libzplay.dll';

procedure Free_libzplay;
procedure Load_libzplay(lib : pchar);
Function Check_libzplay:boolean;


implementation
var
  hlib: tlibhandle;

procedure Free_libzplay;
  begin
    FreeLibrary(hlib);
    zplay_CreateZPlay:=nil;
    zplay_DestroyZPlay:=nil;
    zplay_GetVersion:=nil;
    zplay_GetError:=nil;
    zplay_GetErrorW:=nil;
    zplay_GetFileFormat:=nil;
    zplay_GetFileFormatW:=nil;
    zplay_EnumerateWaveOut:=nil;
    zplay_GetWaveOutInfo:=nil;
    zplay_GetWaveOutInfoW:=nil;
    zplay_SetWaveOutDevice:=nil;
    zplay_OpenFile:=nil;
    zplay_OpenFileW:=nil;
    zplay_AddFile:=nil;
    zplay_AddFileW:=nil;
    zplay_OpenStream:=nil;
    zplay_PushDataToStream:=nil;
    zplay_IsStreamDataFree:=nil;
    zplay_GetDynamicStreamLoad:=nil;
    zplay_GetStreamInfo:=nil;
    zplay_GetStreamInfoW:=nil;
    zplay_Close:=nil;
    zplay_Play:=nil;
    zplay_PlayLoop:=nil;
    zplay_Seek:=nil;
    zplay_ReverseMode:=nil;
    zplay_Stop:=nil;
    zplay_Pause:=nil;
    zplay_Resume:=nil;
    zplay_GetPosition:=nil;
    zplay_SetMasterVolume:=nil;
    zplay_SetPlayerVolume:=nil;
    zplay_GetMasterVolume:=nil;
    zplay_GetPlayerVolume:=nil;
    zplay_GetBitrate:=nil;
    zplay_GetStatus:=nil;
    zplay_MixChannels:=nil;
    zplay_GetVUData:=nil;
    zplay_SlideVolume:=nil;
    zplay_EnableEqualizer:=nil;
    zplay_SetEqualizerPoints:=nil;
    zplay_GetEqualizerPoints:=nil;
    zplay_SetEqualizerParam:=nil;
    zplay_GetEqualizerParam:=nil;
    zplay_LoadID3:=nil;
    zplay_LoadID3W:=nil;
    zplay_LoadFileID3:=nil;
    zplay_LoadFileID3W:=nil;
    zplay_EnableEcho:=nil;
    zplay_SetEchoParam:=nil;
    zplay_GetEchoParam:=nil;
    zplay_SetCallbackFunc:=nil;
    zplay_GetFFTData:=nil;
    zplay_SetRate:=nil;
    zplay_GetRate:=nil;
    zplay_SetPitch:=nil;
    zplay_GetPitch:=nil;
    zplay_SetTempo:=nil;
    zplay_GetTempo:=nil;
    zplay_StereoCut:=nil;
    zplay_DrawFFTGraphOnHDC:=nil;
    zplay_DrawFFTGraphOnHWND:=nil;
    zplay_SetFFTGraphParam:=nil;
    zplay_GetFFTGraphParam:=nil;
    zplay_DetectBPM:=nil;
    zplay_DetectFileBPM:=nil;
    zplay_DetectFileBPMW:=nil;
    zplay_SetEqualizerPreampGain:=nil;
    zplay_GetEqualizerPreampGain:=nil;
    zplay_SetEqualizerBandGain:=nil;
    zplay_GetEqualizerBandGain:=nil;
    zplay_SetSettings:=nil;
    zplay_GetSettings:=nil;
    zplay_strlen:=nil;
    zplay_wcslen:=nil;
    zplay_memcpy:=nil;
    zplay_memmove:=nil;
    zplay_strcpy:=nil;
    zplay_wcscpy:=nil;
    zplay_memset:=nil;
    zplay_LoadID3Ex:=nil;
    zplay_LoadID3ExW:=nil;
    zplay_LoadFileID3Ex:=nil;
    zplay_LoadFileID3ExW:=nil;
    zplay_DrawBitmapToHDC:=nil;
    zplay_DrawBitmapToHWND:=nil;
    zplay_EnumerateWaveIn:=nil;
    zplay_GetWaveInInfo:=nil;
    zplay_GetWaveInInfoW:=nil;
    zplay_SetWaveInDevice:=nil;
    zplay_SetWaveOutFile:=nil;
    zplay_SetWaveOutFileW:=nil;
  end;


procedure Load_libzplay(lib : pchar);
  begin
    hlib:=LoadLibrary(lib);
    if hlib=0 then
      raise Exception.Create(format('Could not load library: %s',[lib]));

    pointer(zplay_CreateZPlay):=GetProcAddress(hlib,'zplay_CreateZPlay');
    pointer(zplay_DestroyZPlay):=GetProcAddress(hlib,'zplay_DestroyZPlay');
    pointer(zplay_GetVersion):=GetProcAddress(hlib,'zplay_GetVersion');
    pointer(zplay_GetError):=GetProcAddress(hlib,'zplay_GetError');
    pointer(zplay_GetErrorW):=GetProcAddress(hlib,'zplay_GetErrorW');
    pointer(zplay_GetFileFormat):=GetProcAddress(hlib,'zplay_GetFileFormat');
    pointer(zplay_GetFileFormatW):=GetProcAddress(hlib,'zplay_GetFileFormatW');
    pointer(zplay_EnumerateWaveOut):=GetProcAddress(hlib,'zplay_EnumerateWaveOut');
    pointer(zplay_GetWaveOutInfo):=GetProcAddress(hlib,'zplay_GetWaveOutInfo');
    pointer(zplay_GetWaveOutInfoW):=GetProcAddress(hlib,'zplay_GetWaveOutInfoW');
    pointer(zplay_SetWaveOutDevice):=GetProcAddress(hlib,'zplay_SetWaveOutDevice');
    pointer(zplay_OpenFile):=GetProcAddress(hlib,'zplay_OpenFile');
    pointer(zplay_OpenFileW):=GetProcAddress(hlib,'zplay_OpenFileW');
    pointer(zplay_AddFile):=GetProcAddress(hlib,'zplay_AddFile');
    pointer(zplay_AddFileW):=GetProcAddress(hlib,'zplay_AddFileW');
    pointer(zplay_OpenStream):=GetProcAddress(hlib,'zplay_OpenStream');
    pointer(zplay_PushDataToStream):=GetProcAddress(hlib,'zplay_PushDataToStream');
    pointer(zplay_IsStreamDataFree):=GetProcAddress(hlib,'zplay_IsStreamDataFree');
    pointer(zplay_GetDynamicStreamLoad):=GetProcAddress(hlib,'zplay_GetDynamicStreamLoad');
    pointer(zplay_GetStreamInfo):=GetProcAddress(hlib,'zplay_GetStreamInfo');
    pointer(zplay_GetStreamInfoW):=GetProcAddress(hlib,'zplay_GetStreamInfoW');
    pointer(zplay_Close):=GetProcAddress(hlib,'zplay_Close');
    pointer(zplay_Play):=GetProcAddress(hlib,'zplay_Play');
    pointer(zplay_PlayLoop):=GetProcAddress(hlib,'zplay_PlayLoop');
    pointer(zplay_Seek):=GetProcAddress(hlib,'zplay_Seek');
    pointer(zplay_ReverseMode):=GetProcAddress(hlib,'zplay_ReverseMode');
    pointer(zplay_Stop):=GetProcAddress(hlib,'zplay_Stop');
    pointer(zplay_Pause):=GetProcAddress(hlib,'zplay_Pause');
    pointer(zplay_Resume):=GetProcAddress(hlib,'zplay_Resume');
    pointer(zplay_GetPosition):=GetProcAddress(hlib,'zplay_GetPosition');
    pointer(zplay_SetMasterVolume):=GetProcAddress(hlib,'zplay_SetMasterVolume');
    pointer(zplay_SetPlayerVolume):=GetProcAddress(hlib,'zplay_SetPlayerVolume');
    pointer(zplay_GetMasterVolume):=GetProcAddress(hlib,'zplay_GetMasterVolume');
    pointer(zplay_GetPlayerVolume):=GetProcAddress(hlib,'zplay_GetPlayerVolume');
    pointer(zplay_GetBitrate):=GetProcAddress(hlib,'zplay_GetBitrate');
    pointer(zplay_GetStatus):=GetProcAddress(hlib,'zplay_GetStatus');
    pointer(zplay_MixChannels):=GetProcAddress(hlib,'zplay_MixChannels');
    pointer(zplay_GetVUData):=GetProcAddress(hlib,'zplay_GetVUData');
    pointer(zplay_SlideVolume):=GetProcAddress(hlib,'zplay_SlideVolume');
    pointer(zplay_EnableEqualizer):=GetProcAddress(hlib,'zplay_EnableEqualizer');
    pointer(zplay_SetEqualizerPoints):=GetProcAddress(hlib,'zplay_SetEqualizerPoints');
    pointer(zplay_GetEqualizerPoints):=GetProcAddress(hlib,'zplay_GetEqualizerPoints');
    pointer(zplay_SetEqualizerParam):=GetProcAddress(hlib,'zplay_SetEqualizerParam');
    pointer(zplay_GetEqualizerParam):=GetProcAddress(hlib,'zplay_GetEqualizerParam');
    pointer(zplay_LoadID3):=GetProcAddress(hlib,'zplay_LoadID3');
    pointer(zplay_LoadID3W):=GetProcAddress(hlib,'zplay_LoadID3W');
    pointer(zplay_LoadFileID3):=GetProcAddress(hlib,'zplay_LoadFileID3');
    pointer(zplay_LoadFileID3W):=GetProcAddress(hlib,'zplay_LoadFileID3W');
    pointer(zplay_EnableEcho):=GetProcAddress(hlib,'zplay_EnableEcho');
    pointer(zplay_SetEchoParam):=GetProcAddress(hlib,'zplay_SetEchoParam');
    pointer(zplay_GetEchoParam):=GetProcAddress(hlib,'zplay_GetEchoParam');
    pointer(zplay_SetCallbackFunc):=GetProcAddress(hlib,'zplay_SetCallbackFunc');
    pointer(zplay_GetFFTData):=GetProcAddress(hlib,'zplay_GetFFTData');
    pointer(zplay_SetRate):=GetProcAddress(hlib,'zplay_SetRate');
    pointer(zplay_GetRate):=GetProcAddress(hlib,'zplay_GetRate');
    pointer(zplay_SetPitch):=GetProcAddress(hlib,'zplay_SetPitch');
    pointer(zplay_GetPitch):=GetProcAddress(hlib,'zplay_GetPitch');
    pointer(zplay_SetTempo):=GetProcAddress(hlib,'zplay_SetTempo');
    pointer(zplay_GetTempo):=GetProcAddress(hlib,'zplay_GetTempo');
    pointer(zplay_StereoCut):=GetProcAddress(hlib,'zplay_StereoCut');
    pointer(zplay_DrawFFTGraphOnHDC):=GetProcAddress(hlib,'zplay_DrawFFTGraphOnHDC');
    pointer(zplay_DrawFFTGraphOnHWND):=GetProcAddress(hlib,'zplay_DrawFFTGraphOnHWND');
    pointer(zplay_SetFFTGraphParam):=GetProcAddress(hlib,'zplay_SetFFTGraphParam');
    pointer(zplay_GetFFTGraphParam):=GetProcAddress(hlib,'zplay_GetFFTGraphParam');
    pointer(zplay_DetectBPM):=GetProcAddress(hlib,'zplay_DetectBPM');
    pointer(zplay_DetectFileBPM):=GetProcAddress(hlib,'zplay_DetectFileBPM');
    pointer(zplay_DetectFileBPMW):=GetProcAddress(hlib,'zplay_DetectFileBPMW');
    pointer(zplay_SetEqualizerPreampGain):=GetProcAddress(hlib,'zplay_SetEqualizerPreampGain');
    pointer(zplay_GetEqualizerPreampGain):=GetProcAddress(hlib,'zplay_GetEqualizerPreampGain');
    pointer(zplay_SetEqualizerBandGain):=GetProcAddress(hlib,'zplay_SetEqualizerBandGain');
    pointer(zplay_GetEqualizerBandGain):=GetProcAddress(hlib,'zplay_GetEqualizerBandGain');
    pointer(zplay_SetSettings):=GetProcAddress(hlib,'zplay_SetSettings');
    pointer(zplay_GetSettings):=GetProcAddress(hlib,'zplay_GetSettings');
    pointer(zplay_strlen):=GetProcAddress(hlib,'zplay_strlen');
    pointer(zplay_wcslen):=GetProcAddress(hlib,'zplay_wcslen');
    pointer(zplay_memcpy):=GetProcAddress(hlib,'zplay_memcpy');
    pointer(zplay_memmove):=GetProcAddress(hlib,'zplay_memmove');
    pointer(zplay_strcpy):=GetProcAddress(hlib,'zplay_strcpy');
    pointer(zplay_wcscpy):=GetProcAddress(hlib,'zplay_wcscpy');
    pointer(zplay_memset):=GetProcAddress(hlib,'zplay_memset');
    pointer(zplay_LoadID3Ex):=GetProcAddress(hlib,'zplay_LoadID3Ex');
    pointer(zplay_LoadID3ExW):=GetProcAddress(hlib,'zplay_LoadID3ExW');
    pointer(zplay_LoadFileID3Ex):=GetProcAddress(hlib,'zplay_LoadFileID3Ex');
    pointer(zplay_LoadFileID3ExW):=GetProcAddress(hlib,'zplay_LoadFileID3ExW');
    pointer(zplay_DrawBitmapToHDC):=GetProcAddress(hlib,'zplay_DrawBitmapToHDC');
    pointer(zplay_DrawBitmapToHWND):=GetProcAddress(hlib,'zplay_DrawBitmapToHWND');
    pointer(zplay_EnumerateWaveIn):=GetProcAddress(hlib,'zplay_EnumerateWaveIn');
    pointer(zplay_GetWaveInInfo):=GetProcAddress(hlib,'zplay_GetWaveInInfo');
    pointer(zplay_GetWaveInInfoW):=GetProcAddress(hlib,'zplay_GetWaveInInfoW');
    pointer(zplay_SetWaveInDevice):=GetProcAddress(hlib,'zplay_SetWaveInDevice');
    pointer(zplay_SetWaveOutFile):=GetProcAddress(hlib,'zplay_SetWaveOutFile');
    pointer(zplay_SetWaveOutFileW):=GetProcAddress(hlib,'zplay_SetWaveOutFileW');
  end;


Function Check_libzplay:boolean;
var
  cdir: string;
  MustFree :boolean ;
begin
  // no error
  MustFree := hlib = 0;

  Load_libzplay(External_library);
  Result:=false;
  // exit, report error
  if (hlib = 0) then
    begin
    end
  else
    begin
      Result:=true;
      if MustFree then
         begin
           UnloadLibrary(hlib);
           hlib := 0;
         end;
    end;
end;

initialization
  hlib := 0;

end.
